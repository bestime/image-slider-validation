var ImageSliderValidation=function(){function e(e){try{e.parentNode.removeChild(e)}catch(e){}}function n(e,n,t){e=e||window.event,n=!1!==n,t=!1!==t,n&&window.event?window.event.cancelBubble=!0:e.stopPropagation(),t&&window.event?window.event.returnValue=!1:e.preventDefault()}function t(){return"https://picsum.photos/300/150/?image=500"}function i(e,n,i){function a(n){if("canvas"===e){var t=document.createElement("img");t.crossOrigin="Anonymous",t.onload=function(){i(t,n.x,n.y)},t.src=n.src}else o(n.src,function(e){i(e,n.x,n.y)})}n?n(a):a({src:t(),x:0,y:0})}function o(e,n){function t(){a++,a===e.length&&n([i,o])}var i=document.createElement("img");i.onload=t,i.crossOrigin="Anonymous",i.className="isv-back",i.src=e[0];var o=document.createElement("img");o.onload=t,o.crossOrigin="Anonymous",o.className="isv-slider",o.src=e[1];var a=0}function a(e,n){var t=document.createElement("canvas");return t.width=e,t.height=n,t}function c(){return'    <div class="isv-loading">      <svg class="isvg" x="0px" y="0px" viewBox="0 0 150 150">        <circle class="isvg-inner" cx="75" cy="75" r="60"/>      </svg>    </div>    '}function s(e,n,t,i){function o(e){e=e||window.event,c(e.clientX-d)}function a(){t(v),document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",a)}function c(t){var i=s.offsetWidth-e;i<0&&(i=0),t>i?t=i:t<0&&(t=0),v=t,l.style.left=v+"px",r.style.width=v+e-2+"px",n(v)}var s=document.createElement("div");s.className="isv_handler_box",s.innerHTML="<span></span><b>"+m+"</b><i></i>";var l,r,u,d=0,v=0;return setTimeout(function(){l=s.getElementsByTagName("span")[0],r=s.getElementsByTagName("i")[0],u=s.getElementsByTagName("b")[0],l.onmousedown=function(e){e=e||window.event,d=e.clientX-v,document.addEventListener("mousemove",o),document.addEventListener("mouseup",a),i()}},50),{el:s,updateLabel:function(e){u.innerHTML=e},reset:function(){c(0),u.innerHTML=m},setSuccess:function(){u.innerHTML="验证成功"},setError:function(){u.innerHTML="验证失败"}}}var l=Math.PI,r=10,u=42,d=u+2*r,m="向右拖动滑块填充拼图",v=19;return function(t){function o(e){D.classList.add("success"),W.setSuccess(),b=setTimeout(function(){t.success&&t.success(e,P-v,y)},1e3)}function f(e){e=!0===e,D.classList.add("fail"),W.setError(),x=setTimeout(function(){w(e),t.error&&t.error(y)},1e3)}function p(){E=!0,D.classList.add("loading"),"canvas"===S?(M.clearRect(0,0,I,B),k.clearRect(0,0,I,B),C.width=I):(e(N),e(C)),i(S,t.onGetImage,function(e,n,t){if("canvas"===S){O=n,P=t+v,g(M,"fill",O,P),g(k,"clip",O,P),M.drawImage(e,0,0,I,B),k.drawImage(e,0,0,I,B);t=P-2*r+2;var i=k.getImageData(O,t,d,d);C.width=d,k.putImageData(i,0,t)}else N=e[0],C=e[1],R.appendChild(e[0]),R.appendChild(e[1]);E=!1,D.classList.remove("loading")})}function g(e,n,t,i){t+=1,e.strokeStyle="rgba(255,255,255,0.5)",e.beginPath(),e.moveTo(t,i),e.lineTo(t+u/2,i),e.arc(t+u/2,i-r+8,r-2,.5*l,2.5*l),e.lineTo(t+u/2,i),e.lineTo(t+u,i),e.lineTo(t+u,i+u/2),e.arc(t+u+r-8,i+u/2,r-2,l,3*l),e.lineTo(t+u,i+u/2),e.lineTo(t+u,i+u),e.lineTo(t+26,i+29),e.lineTo(t,i+u),e.lineTo(t+15,i+15),e.lineTo(t,i),e.stroke(),e.fillStyle="#fff",e[n](),e.beginPath(),e.globalCompositeOperation="xor",e.fill()}function h(){P<v?P=v:P>B-d+v&&(P=B-d+v),O<0?O=0:O>I-d&&(O=I-d)}function T(){clearTimeout(b),clearTimeout(x),D.classList.remove("success"),D.classList.remove("fail"),W.updateLabel(m)}function w(e){e=!0===e,e&&E||(T(),C.style.left="0px",W.reset(),e&&p())}function L(){D.classList.add("active")}function y(){D.classList.remove("active")}var E,x,b,N,C,M,k,I=t.width||310,B=t.height||155,H=t.wrapper,S=t.mode||"canvas",O=0,P=0,A=t.sliderButtonWidth||40,D=document.createElement("div"),R=document.createElement("div"),U=document.createElement("div"),V=document.createElement("div");U.className="isv-refresh",V.className="isv-close",R.className="isv-canvas",D.className="image-slider-validation loading",D.onclick=n,h(),"canvas"===S&&(N=a(I,B),C=N.cloneNode(!0),M=N.getContext("2d"),k=C.getContext("2d"),N.className="isv-back",C.className="isv-slider",R.appendChild(N),R.appendChild(C)),R.appendChild(U),R.appendChild(V),D.innerHTML+=c(),D.appendChild(R);var W=s(A,function(e){C.style.left=e+"px"},function(e){"canvas"===S?(clearTimeout(b),clearTimeout(x),Math.abs(e-O)<=2?o():f()):t.onMouseUp&&t.onMouseUp(e,function(){clearTimeout(b),clearTimeout(x),o(e)},f)},function(){T()});return D.appendChild(W.el),H.appendChild(D),p(),V.onclick=function(){y(),t.close&&t.close()},U.onclick=function(){w(!0)},{show:L,close:y,reLoad:function(){w(!0)}}}}();